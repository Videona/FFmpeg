diff --git a/configure b/configure
index 827abfe694..d433eaecfe 100755
--- a/configure
+++ b/configure
@@ -5018,7 +5018,7 @@ case $target_os in
         enable section_data_rel_ro
         SLIB_INSTALL_NAME='$(SLIBNAME)'
         SLIB_INSTALL_LINKS=
-        SHFLAGS='-shared -Wl,-soname,$(SLIBNAME)'
+        SHFLAGS='-shared -soname $(SLIBNAME)'
         ;;
     haiku)
         prefix_default="/boot/common"
diff --git a/fftools/ffmpeg.c b/fftools/ffmpeg.c
index c0214c42d8..5a073775e1 100644
--- a/fftools/ffmpeg.c
+++ b/fftools/ffmpeg.c
@@ -4849,6 +4849,6 @@ int main(int argc, char **argv)
     if ((decode_error_stat[0] + decode_error_stat[1]) * max_error_rate < decode_error_stat[1])
         exit_program(69);
 
-    exit_program(received_nb_signals ? 255 : main_return_code);
+    ffmpeg_cleanup(received_nb_signals ? 255 : main_return_code);
     return main_return_code;
 }
diff --git a/libavdevice/v4l2.c b/libavdevice/v4l2.c
index 10a0ff0dd6..413963edfb 100644
--- a/libavdevice/v4l2.c
+++ b/libavdevice/v4l2.c
@@ -95,7 +95,7 @@ struct video_data {
     int (*open_f)(const char *file, int oflag, ...);
     int (*close_f)(int fd);
     int (*dup_f)(int fd);
-    int (*ioctl_f)(int fd, unsigned long int request, ...);
+    int (*ioctl_f)(int fd, unsigned int request, ...);
     ssize_t (*read_f)(int fd, void *buffer, size_t n);
     void *(*mmap_f)(void *start, size_t length, int prot, int flags, int fd, int64_t offset);
     int (*munmap_f)(void *_start, size_t length);
